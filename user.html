<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />

    <title>Inner Page - Medilab Bootstrap Template</title>
    <meta content name="description" />
    <meta content name="keywords" />

    <!-- Favicons -->
    <link href="assets/img/favicon.png" rel="icon" />
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon" />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
      rel="stylesheet"
    />

    <!-- Vendor CSS Files -->
    <link
      href="assets/vendor/fontawesome-free/css/all.min.css"
      rel="stylesheet"
    />
    <link href="assets/vendor/animate.css/animate.min.css" rel="stylesheet" />
    <link
      href="assets/vendor/bootstrap/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="assets/vendor/bootstrap-icons/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet" />
    <link
      href="assets/vendor/glightbox/css/glightbox.min.css"
      rel="stylesheet"
    />
    <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet" />
    <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet" />

    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet" />

    <style>
      /* Custom styles for the sign-up form */
      .signup-form-container {
        display: none;
        justify-content: center;
        align-items: center;
        min-height: 100vh; /* Set minimum height to 100% of the viewport height */
      }

      .signup-form {
        width: 400px;
        padding: 30px;
        background-color: #f1f7fd;
        border-radius: 10px;
        box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.1);
      }

      .signup-form h2 {
        text-align: center;
        margin-bottom: 20px;
      }

      .signup-form input[type="text"],
      .signup-form input[type="email"],
      .signup-form input[type="password"],
      .signup-form input[type="date"],
      .signup-form select {
        width: 100%;
        padding: 1px;
        margin-bottom: 15px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;
      }

      .signup-form input[type="submit"] {
        width: 100%;
        padding: 1px;
        border: none;
        border-radius: 5px;
        background-color: blue;
        color: #fff;
        cursor: pointer;
      }

      .signup-form input[type="submit"]:hover {
        background-color: lightblue;
      }

      .error-message {
        color: red;
      }
    </style>
  </head>

  <body>
    <!-- ======= Header ======= -->
    <header id="header" class="fixed-top">
      <div class="container d-flex align-items-center">
        <h1 class="logo me-auto"><a href="index.html">Kiddo Shield</a></h1>
        <!-- Uncomment below if you prefer to use an image logo -->
        <!-- <a href="index.html" class="logo me-auto"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->

        <nav id="navbar" class="navbar order-last order-lg-0">
          <ul>
            <li><a class="nav-link scrollto" href="index.html">Home</a></li>
            <li>
              <a class="nav-link scrollto" href="index.html#about">About</a>
            </li>
            <li>
              <a class="nav-link scrollto" href="index.html#services"
                >Vaccination Schedule</a
              >
            </li>
            <li>
              <a class="nav-link scrollto" href="diseases.html"
                >Vaccination Preventable Diseases</a
              >
            </li>

            <li>
              <a class="nav-link scrollto" href="index.html#contact">Contact</a>
            </li>
          </ul>
          <i class="bi bi-list mobile-nav-toggle"></i>
        </nav>
        <!-- .navbar -->

        <a href="#" id="logoutBtn" class="appointment-btn scrollto"
          ><span class="d-none d-md-inline">Log</span> Out</a
        >
      </div>
    </header>
    <!-- End Header -->

    <main id="main">
      <section class="inner-page">
        <div class="container">
          <section id="departments" class="departments">
            <div class="container">
              <div class="section-title">
                <h2>User</h2>
              </div>

              <div class="row gy-4">
                <div class="col-lg-3">
                  <ul class="nav nav-tabs flex-column">
                    <li class="nav-item">
                      <a
                        class="nav-link active show"
                        data-bs-toggle="tab"
                        href="#tab-1"
                        onclick="toggleChildDetails()"
                        >Add Child Details</a
                      >
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" data-bs-toggle="tab" href="#tab-2"
                        >Vaccine</a
                      >
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" data-bs-toggle="tab" href="#tab-3"
                        >Notification</a
                      >
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" data-bs-toggle="tab" href="#tab-3"
                        >View Child</a
                      >
                    </li>
                  </ul>
                </div>
                <div class="col-lg-9">
                  <div class="tab-content">
                    <div class="tab-pane active show" id="tab-1">
                      <div class="row gy-4">
                        <div class="col-lg-8 details order-2 order-lg-1">
                          <h3></h3>
                          <div id="child-details" class="signup-form-container">
                            <form
                              class="signup-form"
                              id="add_child_form"
                              onsubmit="addChild(event)"
                            >
                              <h2>Add Child Details</h2>
                              <label for="child-full-name"
                                >Child's Full Name:</label
                              ><br />
                              <input
                                type="text"
                                id="child-full-name"
                                name="childFullName"
                                required
                              /><br />

                              <label>Child Gender:</label><br />
                              <input
                                type="radio"
                                id="male"
                                name="childGender"
                                value="male"
                              />
                              <label for="male">Male</label>
                              <input
                                type="radio"
                                id="female"
                                name="childGender"
                                value="female"
                              />
                              <label for="female">Female</label>
                              <br /><br />

                              <label for="child-birthdate"
                                >Child Birth Date:</label
                              ><br />
                              <input
                                type="date"
                                id="child-birthdate"
                                name="childBirthdate"
                                required
                              /><br />

                              <div id="child-details">
                                <label for="child-age">Child Age:</label><br />
                                <input
                                  type="number"
                                  id="child-age"
                                  name="childAge"
                                  required
                                  placeholder="Age"
                                /><br />

                                <label for="country">Country:</label><br />
                                <input
                                  type="text"
                                  id="country"
                                  name="country"
                                  required
                                /><br />

                                <label for="state">State:</label><br />
                                <input
                                  type="text"
                                  id="state"
                                  name="state"
                                  required
                                /><br />

                                <label for="district">District:</label><br />
                                <input
                                  type="text"
                                  id="district"
                                  name="district"
                                  required
                                /><br />

                                <label for="child-weight">Weight:</label><br />
                                <input
                                  type="number"
                                  id="child-weight"
                                  name="childWeight"
                                  required
                                  placeholder="Weight"
                                /><br /><br />

                                <label for="child-height">Child Height:</label
                                ><br />
                                <input
                                  type="number"
                                  id="child-height"
                                  name="childHeight"
                                  required
                                  placeholder="Height"
                                /><br /><br />

                                <label for="blood-group">Blood Group:</label
                                ><br />
                                <select
                                  id="blood_group"
                                  name="blood_group"
                                  required
                                >
                                  <option value="">Select blood group</option>
                                  <option value="A+">A+</option>
                                  <option value="A-">A-</option>
                                  <option value="B+">B+</option>
                                  <option value="B-">B-</option>
                                  <option value="AB+">AB+</option>
                                  <option value="AB-">AB-</option>
                                  <option value="O+">O+</option>
                                  <option value="O-">O-</option></select
                                ><br /><br />
                              </div>
                              <br />
                              <input type="submit" value="Submit" />
                            </form>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="tab-pane" id="tab-2">
                      <div class="row gy-4">
                        <div class="col-lg-8 details order-2 order-lg-1">
                          <h3>Add Vaccine</h3>
                          <form>
                            <div class="mb-3">
                              <label for="vaccineName" class="form-label"
                                >Name of Vaccine</label
                              >
                              <select
                                class="form-select"
                                id="vaccineName"
                                name="vaccineName"
                              >
                                <option selected>Select a vaccine</option>
                                <option value="vaccine1">Vaccine 1</option>
                                <option value="vaccine2">Vaccine 2</option>
                                <option value="vaccine3">Vaccine 3</option>
                                <!-- Add more options for different vaccines -->
                              </select>
                            </div>
                            <button type="submit" class="btn btn-primary">
                              Submit
                            </button>
                          </form>
                        </div>
                      </div>
                    </div>
                    <div class="tab-pane" id="tab-3">
                      <div class="tab-pane active show" id="tab-1">
                        <div class="row gy-4">
                          <div class="col-lg-8 details order-2 order-lg-1">
                            <div class="col-lg-9">
                              <div class="tab-content">
                                <div class="tab-pane active show" id="tab-1">
                                  <div class="row gy-4">
                                    <div
                                      class="col-lg-8 details order-2 order-lg-1"
                                    >
                                      <h3>Notification</h3>
                                      <ul id="child-list"></ul>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <script>
                                function showChildDetails(name) {
                                  localStorage.setItem("selectedChild", name);
                                  window.open("child-details.html", "_blank");
                                }
                              </script>
                            </div>

                            <div id="child-details"></div>
                          </div>
                        </div>
                      </div>
                      <!-- Notification tab content -->
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>
      </section>
    </main>

    <div id="preloader"></div>
    <a
      href="#"
      class="back-to-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>

    <script>
      const token = localStorage.getItem("token");

      if (!token) {
        window.location.href = "index.html";
      }
    </script>

    <!-- Vendor JS Files -->
    <script src="../assets/vendor/purecounter/purecounter_vanilla.js"></script>
    <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="../assets/vendor/swiper/swiper-bundle.min.js"></script>
    <script src="../assets/vendor/php-email-form/validate.js"></script>

    <!-- Template Main JS File -->
    <script src="../assets/js/main.js"></script>

    <script>
      function toggleChildDetails() {
        const childDetailsForm = document.getElementById("child-details");
        if (childDetailsForm.style.display === "none") {
          childDetailsForm.style.display = "block";
        } else {
          childDetailsForm.style.display = "none";
        }
      }
    </script>
    <script>
      function fetchAndDisplayChildNames() {
          const token = localStorage.getItem("token");
  
          fetch('http://localhost:3000/get_child_names', {
              method: 'GET',
              headers: {
                  Authorization: token,
                  'Content-Type': 'application/json',
              }
          })
          .then(response => {
              if (!response.ok) {
                  throw new Error('Failed to fetch child names');
              }
              return response.json();
          })
          .then(data => {
            console.log(data)
              const childList = document.getElementById('child-list');
              childList.innerHTML = '';
  
              if (Array.isArray(data.childNames)) {
                  data.childNames.forEach(child => {
            console.log(child)

                      const listItem = document.createElement('li');
                      const link = document.createElement('a');
                      link.href = `notification.html?name=${encodeURIComponent(child)}`;
                      link.textContent = child;
                      listItem.appendChild(link);
                      childList.appendChild(listItem);
                  });
              } else {
                  console.error('Error: Data is not an array.');
              }
          })
          .catch(error => {
              console.error('Error fetching child names:', error);
              alert('Failed to fetch child names. Please try again.');
          });
      }
  
      // Call the function to fetch and display child names when the page loads
      window.addEventListener('load', fetchAndDisplayChildNames);
  </script>

    <script>
      document
        .getElementById("logoutBtn")
        .addEventListener("click", function (event) {
          event.preventDefault();

          // Remove token from localStorage
          localStorage.removeItem("token");

          window.location.href = "index.html";
        });
    </script>

    <script>
      async function addChild(event) {
        event.preventDefault();

        // Get form data
        const formData = new FormData(
          document.getElementById("add_child_form")
        );

        try {
          const token = localStorage.getItem("token");
          const response = await fetch("http://localhost:3000/add_child", {
            method: "POST",
            headers: {
              Authorization: `${token}`,
              "Content-Type": "application/json",
            },
            body: JSON.stringify(Object.fromEntries(formData)),
          });

          if (response.ok) {
            console.log("Child added successfully");
            alert('Child added successfully!');
        document.getElementById('add_child_form').reset();
          } else {
            // Error handling
            console.error("Failed to add child:", response.statusText);
          }
        } catch (error) {
          // Error handling
          console.error("Error adding child:", error.message);
        }
      }
    </script>
  </body>
</html>
